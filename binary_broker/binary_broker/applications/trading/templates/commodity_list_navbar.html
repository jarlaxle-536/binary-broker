{% load i18n %}

<nav class="navbar navbar-expand navbar-dark bg-secondary flex-md-column flex-row justify-content-center">

  <h5 class="display-6 text-white" style="text-align: center;">
    {% trans 'CommoditiesListCaption' %}
  </h5>

  <table class="table text-white">
    <thead>
      <tr>
        <th scope="col">
          {% trans 'Commodity' %}
        </th>
        <th scope="col">
          {% trans 'Price' %}
        </th>
        <th scope="col">
          {% trans 'Direction' %}
        </th>
      </tr>
    </thead>
    <tbody>
    {% for commodity in commodity_list %}
      <tr>
        <td id="cmd_{{commodity.pk}}_name">
          <a href="{% url 'commodity_detail' commodity.pk %}" class="nounderline text-white">
            {{commodity.name}}
          </a>
        </td>
        <td id="cmd_{{commodity.pk}}_price">
          {{commodity.price}}
        </td>
        <td id="cmd_{{commodity.pk}}_direction">
          0
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</nav>

<script>
  console.log(window.location.host);
  var socket = new WebSocket('ws://' + window.location.host + '/trading/');

  socket.onopen = function open() {
    console.log('WebSockets connection created.');
  };

  socket.onmessage = function(e) {
    update_commodities_list();
  };

  if (socket.readyState == WebSocket.OPEN) {
    socket.onopen();
  };
</script>
